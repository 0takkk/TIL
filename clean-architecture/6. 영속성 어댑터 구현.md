### 의존성 역전
`영속성 어댑터`는 `아웃고잉 어댑터` 또는 `주도되는 어댑터`이다.  
애플리케이션 코어가 주도하고, 영속성 어댑터가 응답만 하는 구조를 의미한다.  
즉, 영속성 어댑터는 직접 애플리케이션을 호출하지 않고, 애플리케이션 서비스에 의해 호출된다.  

![](https://i.imgur.com/66VnaDr.png)  
이 구조는 `의존성 역전 원칙`이 적용된 모습이다.  
코어에 위치한 서비스는 영속성 계층에 직접 의존하지 않고, `포트 인터페이스`를 통해 간접적으로 접근한다.   
이를 통해, 영속성 문제를 신경쓰지 않고 도메인 코드를 개발할 수 있다.  

<br>

### 포트 인터페이스 나누기
영속성 접근을 위한 포트를 정의할 때, **너무 많은 기능을 한 인터페이스(ex. `AccountRepository`)에 몰아 넣는 것**은 바람직하지 않다.  
![](https://i.imgur.com/COhUKz5.png)  
`RegisterAccountService`는 계좌 등록만 필요하지만, `AccountRepository`에 조회, 수정, 삭제 등 여러 메서드가 들어 있다면, 서비스는 실제로 필요하지 않은 기능까지 의존하게 된다.  
이는 서비스의 테스트를 위한 포트 모킹이 복잡해지며, 인터페이스 분리 원칙을 위반한다.  

<br>

![](https://i.imgur.com/CkNGvLP.png)  
인터페이스를 **기능별로 작게 나누면** 각 서비스는 오직 필요한 포트에만 의존하게 된다.  
